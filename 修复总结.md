# ğŸ”§ ä¿®å¤æ€»ç»“

## é—®é¢˜è¯Šæ–­

è®¿é—® http://39.97.168.66/ å‘ç°ï¼š
- âœ… é¦–é¡µæ­£å¸¸
- âœ… åç«¯ API æ­£å¸¸
- âŒ æ•°æ®åº“ç®¡ç†é¡µé¢æ— æ³•æ‰“å¼€
- âŒ åœ°è´¨å»ºæ¨¡é¡µé¢æ— æ³•æ‰“å¼€
- âŒ ç§‘ç ”ç»˜å›¾å·¥ä½œå°é¡µé¢æ— æ³•æ‰“å¼€

**æ ¹æœ¬åŸå› ï¼šå‰ç«¯æ„å»ºæ—¶ä»£ç åˆ†å‰²å¤±è´¥**

æœåŠ¡å™¨æ„å»ºçš„ HTML åªåŒ…å« 2 ä¸ª JS æ–‡ä»¶ï¼š
- `js/chunk-vendors.044824db.js`
- `js/app.70470cee.js`

ä½†è·¯ç”±ä½¿ç”¨äº†æ‡’åŠ è½½ï¼Œéœ€è¦è¿™äº›æ–‡ä»¶ï¼š
- `js/database.xxxxx.js` â† ç¼ºå¤±
- `js/modeling.xxxxx.js` â† ç¼ºå¤±
- `js/visualization.xxxxx.js` â† ç¼ºå¤±

## å·²å®Œæˆçš„ä¿®å¤

### 1. ä¿®å¤ `frontend/vue.config.js`

æ·»åŠ äº†æ˜ç¡®çš„ä»£ç åˆ†å‰²é…ç½®ï¼š

```javascript
configureWebpack: {
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        vendor: { ... },
        elementPlus: { ... },
        echarts: { ... }
      }
    }
  }
}
```

### 2. åˆ›å»ºä¿®å¤æ–‡æ¡£

- âœ… `æœåŠ¡å™¨é¡µé¢æ— æ³•æ‰“å¼€ä¿®å¤æŒ‡å—.md` - è¯¦ç»†ä¿®å¤æ­¥éª¤
- âœ… `æœåŠ¡å™¨ç´§æ€¥ä¿®å¤å‘½ä»¤.md` - å¿«é€Ÿå‘½ä»¤å‚è€ƒ
- âœ… `scripts/fix_server_pages.sh` - Linux è‡ªåŠ¨ä¿®å¤è„šæœ¬
- âœ… `scripts/fix_server_pages.ps1` - Windows ä¿®å¤è„šæœ¬

## æœåŠ¡å™¨ç«¯æ‰§è¡Œæ­¥éª¤

### æ–¹æ³• 1: ä¸€é”®ä¿®å¤ï¼ˆæ¨èï¼‰

```bash
cd /path/to/xitong
docker-compose down
docker-compose build --no-cache frontend
docker-compose up -d
```

### æ–¹æ³• 2: ä½¿ç”¨è‡ªåŠ¨è„šæœ¬

```bash
cd /path/to/xitong
bash scripts/fix_server_pages.sh
```

### éªŒè¯ä¿®å¤

```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ç”Ÿæˆ
docker exec $(docker-compose ps -q frontend) ls -lh /usr/share/nginx/html/js/

# åº”è¯¥çœ‹åˆ°ï¼š
# database.xxxxx.js
# modeling.xxxxx.js
# visualization.xxxxx.js
```

## æµ‹è¯•é¡µé¢

ä¿®å¤åè®¿é—®è¿™äº› URL ç¡®è®¤ï¼š

- http://39.97.168.66/database-viewer
- http://39.97.168.66/geological-modeling
- http://39.97.168.66/visualization

## æ³¨æ„äº‹é¡¹

âš ï¸ **å¿…é¡»ä½¿ç”¨ `--no-cache` å‚æ•°**

å¦‚æœä¸åŠ  `--no-cache`ï¼ŒDocker ä¼šä½¿ç”¨ç¼“å­˜çš„æ—§é…ç½®æ–‡ä»¶ï¼Œå¯¼è‡´ä¿®å¤æ— æ•ˆã€‚

æ­£ç¡®ï¼š
```bash
docker-compose build --no-cache frontend  âœ…
```

é”™è¯¯ï¼š
```bash
docker-compose build frontend  âŒ
```

## æ—¶é—´ä¼°ç®—

- åœæ­¢å®¹å™¨ï¼š10 ç§’
- é‡æ–°æ„å»ºï¼š2-5 åˆ†é’Ÿ
- å¯åŠ¨æœåŠ¡ï¼š30 ç§’
- æ€»è®¡ï¼š**çº¦ 3-6 åˆ†é’Ÿ**

## åç»­å»ºè®®

1. **æµ‹è¯•æ‰€æœ‰é¡µé¢åŠŸèƒ½**
   - æ•°æ®å¯¼å…¥
   - å…³é”®å±‚è®¡ç®—
   - åœ°è´¨å»ºæ¨¡
   - ç§‘ç ”ç»˜å›¾

2. **ç›‘æ§æ—¥å¿—**
   ```bash
   docker-compose logs -f
   ```

3. **æµè§ˆå™¨æ¸…é™¤ç¼“å­˜**
   ç”¨æˆ·é¦–æ¬¡è®¿é—®ä¿®å¤åçš„ç½‘ç«™æ—¶ï¼Œå»ºè®®æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ã€‚

## æŠ€æœ¯ç»†èŠ‚

### ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Ÿ

æ—§çš„ `vue.config.js` å¤ªç®€å•ï¼š
```javascript
module.exports = defineConfig({
  transpileDependencies: true,
  devServer: { ... }
})
```

webpack åœ¨ç”Ÿäº§æ¨¡å¼ä¸‹å¯èƒ½ç¦ç”¨äº†ä»£ç åˆ†å‰²ï¼Œå¯¼è‡´æ‰€æœ‰ä»£ç æ‰“åŒ…åˆ°ä¸€ä¸ª `app.js` æ–‡ä»¶ä¸­ã€‚

### ä¿®å¤åçš„æ•ˆæœ

æ–°é…ç½®æ˜ç¡®å¯ç”¨ä»£ç åˆ†å‰²ï¼š
- ä¸»åº”ç”¨ï¼š`app.js` (~100KB)
- ç¬¬ä¸‰æ–¹åº“ï¼š`chunk-vendors.js` (~500KB)
- Element Plusï¼š`chunk-element-plus.js` (~300KB)
- EChartsï¼š`chunk-echarts.js` (~800KB)
- æ•°æ®åº“é¡µé¢ï¼š`database.js` (~50KB)
- åœ°è´¨å»ºæ¨¡ï¼š`modeling.js` (~150KB)
- ç§‘ç ”ç»˜å›¾ï¼š`visualization.js` (~80KB)
- ...

**ä¼˜åŠ¿ï¼š**
- âœ… é¦–æ¬¡åŠ è½½æ›´å¿«ï¼ˆåªåŠ è½½å¿…éœ€çš„ä»£ç ï¼‰
- âœ… æŒ‰éœ€åŠ è½½ï¼ˆè®¿é—®å“ªä¸ªé¡µé¢æ‰åŠ è½½å¯¹åº”ä»£ç ï¼‰
- âœ… ç¼“å­˜æ•ˆç‡æ›´é«˜ï¼ˆç¬¬ä¸‰æ–¹åº“ç‹¬ç«‹ç¼“å­˜ï¼‰

## æ–‡ä»¶æ¸…å•

æœ¬æ¬¡ä¿®å¤æ¶‰åŠçš„æ–‡ä»¶ï¼š

```
xitong/
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ vue.config.js                        â† æ ¸å¿ƒä¿®å¤
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ fix_server_pages.sh                  â† è‡ªåŠ¨ä¿®å¤è„šæœ¬ï¼ˆLinuxï¼‰
â”‚   â””â”€â”€ fix_server_pages.ps1                 â† è‡ªåŠ¨ä¿®å¤è„šæœ¬ï¼ˆWindowsï¼‰
â”œâ”€â”€ æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—.md                         â† å·²æ›´æ–°
â”œâ”€â”€ æœåŠ¡å™¨é¡µé¢æ— æ³•æ‰“å¼€ä¿®å¤æŒ‡å—.md             â† æ–°å»º
â”œâ”€â”€ æœåŠ¡å™¨ç´§æ€¥ä¿®å¤å‘½ä»¤.md                     â† æ–°å»º
â””â”€â”€ ä¿®å¤æ€»ç»“.md                               â† æœ¬æ–‡ä»¶
```

## è”ç³»æ”¯æŒ

å¦‚æœé—®é¢˜ä»æœªè§£å†³ï¼Œè¯·æä¾›ï¼š

1. æ„å»ºæ—¥å¿—ï¼š`docker-compose build --no-cache frontend 2>&1 | tee build.log`
2. æ–‡ä»¶åˆ—è¡¨ï¼š`docker exec $(docker-compose ps -q frontend) ls -R /usr/share/nginx/html/`
3. æµè§ˆå™¨æ§åˆ¶å°æˆªå›¾ï¼ˆF12 â†’ Consoleï¼‰
4. nginx æ—¥å¿—ï¼š`docker-compose logs frontend --tail=100`

---

**ç¥ä¿®å¤é¡ºåˆ©ï¼** ğŸ‰

å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œéšæ—¶è”ç³»æŠ€æœ¯æ”¯æŒã€‚
