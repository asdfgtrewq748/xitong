# 图例显示优化说明

## 问题
原来的实现中，图例显示了所有surface的名称，包括：
- 岩层名 (顶)
- 岩层名 (底)
- 岩层名 (前侧)
- 岩层名 (后侧)
- 岩层名 (左侧)
- 岩层名 (右侧)

导致图例过长、重复，且不能整体控制一个岩层的显示/隐藏。

## 修复方案

### 1. 统一series命名
将每个岩层的所有6个面（顶、底、前、后、左、右）都使用相同的名称：
```javascript
series.push({
  type: 'surface',
  name: model.name, // 不再添加 (顶)、(底) 等后缀
  // ... 其他配置
});
```

### 2. 优化图例数据
图例只显示唯一的岩层名称：
```javascript
legend: { 
  data: [...new Set(res.models.map(m => m.name))], // 去重，只显示岩层名
  // ... 其他配置
}
```

### 3. 简化tooltip
移除面类型显示，只显示岩层名称和坐标信息：
```javascript
formatter: (p) => {
  const layerName = p.seriesName;
  return `岩层: ${layerName}
          X: ${p.value[0].toFixed(2)} m
          Y: ${p.value[1].toFixed(2)} m
          Z: ${p.value[2].toFixed(2)} m`;
}
```

## 效果

### 修复前
图例显示：
- 煤层1 (顶)
- 煤层1 (底)
- 煤层1 (前侧)
- 煤层1 (后侧)
- 煤层1 (左侧)
- 煤层1 (右侧)
- 岩层2 (顶)
- 岩层2 (底)
- ...

### 修复后
图例显示：
- 煤层1
- 岩层2
- 岩层3
- ...

### 交互行为
- 点击图例中的岩层名，同时显示/隐藏该岩层的所有6个面
- 勾选的岩层正常显示，取消勾选的岩层完全隐藏
- 图例更简洁，易于操作

## 修改文件
- `frontend/src/components/GeologicalModelingView.vue` (约1080-1430行)

## 测试要点
1. ✅ 图例只显示岩层名称，无重复
2. ✅ 点击图例可以控制整个岩层的显示/隐藏
3. ✅ 全选/反选按钮正常工作
4. ✅ Tooltip显示正确的岩层信息

## 修复日期
2025年10月29日
