<template>
  <div class="dashboard-container">
    <!-- æ¬¢è¿æ¨ªå¹… -->
    <el-row :gutter="20">
      <el-col :span="24">
        <el-card shadow="hover" class="welcome-card">
          <div class="welcome-content">
            <div class="welcome-text">
              <h1>ğŸ”ï¸ çŸ¿å±±å·¥ç¨‹åˆ†æç³»ç»Ÿ</h1>
              <p>ä¸“ä¸šçš„ç…¤çŸ¿åœ°è´¨æ•°æ®åˆ†æä¸ä¸‰ç»´å»ºæ¨¡å¹³å°</p>
              <div class="feature-tags">
                <el-tag type="success" effect="plain">å…³é”®å±‚è®¡ç®—</el-tag>
                <el-tag type="primary" effect="plain">ä¸‰ç»´åœ°è´¨å»ºæ¨¡</el-tag>
                <el-tag type="warning" effect="plain">é’»å­”æ•°æ®åˆ†æ</el-tag>
                <el-tag type="info" effect="plain">å²©æ€§å‚æ•°æŸ¥è¯¢</el-tag>
              </div>
            </div>
            <div class="welcome-action">
              <el-button type="primary" size="large" @click="showQuickStart = true">
                <el-icon style="margin-right: 8px;"><Guide /></el-icon>
                å¿«é€Ÿå¼€å§‹æ•™ç¨‹
              </el-button>
            </div>
          </div>
        </el-card>
      </el-col>
    </el-row>

    <!-- æ•°æ®ç»Ÿè®¡å¡ç‰‡ -->
    <el-row :gutter="20" class="stats-row">
      <el-col :span="6">
        <el-card shadow="hover" class="stat-card">
          <div class="stat-item">
            <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"><el-icon><Coin /></el-icon></div>
            <div class="stat-text">
              <div class="stat-title">å²©çŸ³æ•°æ®åº“</div>
              <div class="stat-value">{{ stats.rock_db_count }}</div>
              <div class="stat-label">æ¡è®°å½•</div>
            </div>
          </div>
        </el-card>
      </el-col>
      <el-col :span="6">
        <el-card shadow="hover" class="stat-card">
          <div class="stat-item">
            <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"><el-icon><Files /></el-icon></div>
            <div class="stat-text">
              <div class="stat-title">é’»å­”æ–‡ä»¶</div>
              <div class="stat-value">{{ stats.borehole_file_count }}</div>
              <div class="stat-label">ä¸ªæ–‡ä»¶</div>
            </div>
          </div>
        </el-card>
      </el-col>
      <el-col :span="6">
        <el-card shadow="hover" class="stat-card">
          <div class="stat-item">
            <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);"><el-icon><Picture /></el-icon></div>
            <div class="stat-text">
              <div class="stat-title">å»ºæ¨¡æ•°æ®</div>
              <div class="stat-value">{{ stats.modeling_record_count }}</div>
              <div class="stat-label">æ¡è®°å½•</div>
            </div>
          </div>
        </el-card>
      </el-col>
      <el-col :span="6">
        <el-card shadow="hover" class="stat-card">
          <div class="stat-item">
            <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);"><el-icon><DataAnalysis /></el-icon></div>
            <div class="stat-text">
              <div class="stat-title">å…¨å±€é’»å­”</div>
              <div class="stat-value">{{ uniqueBoreholes }}</div>
              <div class="stat-label">ä¸ªé’»å­”</div>
            </div>
          </div>
        </el-card>
      </el-col>
    </el-row>

    <!-- åŠŸèƒ½æ¨¡å—å¡ç‰‡ -->
    <el-row :gutter="20" class="feature-row">
      <el-col :span="6">
        <el-card shadow="hover" class="feature-card" @click="$router.push('/key-stratum')">
          <div class="feature-icon" style="background-color: #409EFF;">
            <el-icon><DataAnalysis /></el-icon>
          </div>
          <h3>å…³é”®å±‚è®¡ç®—</h3>
          <p>åŸºäºå²©å±‚åŠ›å­¦å‚æ•°,è‡ªåŠ¨è®¡ç®—å¹¶æ ‡è¯†ç…¤å±‚ä¸Šè¦†å…³é”®å±‚ä½ç½®,è¯„ä¼°é¡¶æ¿ç¨³å®šæ€§</p>
          <div class="feature-footer">
            <el-button type="primary" link>ç«‹å³ä½¿ç”¨ â†’</el-button>
          </div>
        </el-card>
      </el-col>
      <el-col :span="6">
        <el-card shadow="hover" class="feature-card" @click="$router.push('/geological-modeling')">
          <div class="feature-icon" style="background-color: #67C23A;">
            <el-icon><Picture /></el-icon>
          </div>
          <h3>ä¸‰ç»´åœ°è´¨å»ºæ¨¡</h3>
          <p>åŸºäºé’»å­”æ•°æ®,ç”Ÿæˆç…¤å±‚ä¸‰ç»´å—ä½“æ¨¡å‹,æ”¯æŒå¤šç§æ’å€¼æ–¹æ³•å’Œå¯è§†åŒ–åˆ†æ</p>
          <div class="feature-footer">
            <el-button type="success" link>ç«‹å³ä½¿ç”¨ â†’</el-button>
          </div>
        </el-card>
      </el-col>
      <el-col :span="6">
        <el-card shadow="hover" class="feature-card" @click="$router.push('/upward-mining-feasibility')">
          <div class="feature-icon" style="background-color: #f59e0b;">
            <el-icon><TrendCharts /></el-icon>
          </div>
          <h3>ä¸Šè¡Œå¼€é‡‡å¯è¡Œåº¦</h3>
          <p>åŸºäºé’»å­”CSVæ•°æ®è®¡ç®—ä¸Šè¡Œå¼€é‡‡å¯è¡Œåº¦,è¯„ä¼°é¡¶æ¿ç¨³å®šæ€§</p>
          <div class="feature-footer">
            <el-button type="warning" link>ç«‹å³ä½¿ç”¨ â†’</el-button>
          </div>
        </el-card>
      </el-col>
      <el-col :span="6">
        <el-card shadow="hover" class="feature-card" @click="$router.push('/database-viewer')">
          <div class="feature-icon" style="background-color: #E6A23C;">
            <el-icon><Coin /></el-icon>
          </div>
          <h3>å²©æ€§æ•°æ®åº“</h3>
          <p>æŸ¥è¯¢ã€ç¼–è¾‘å²©çŸ³åŠ›å­¦å‚æ•°æ•°æ®åº“,æ”¯æŒæŒ‰å²©æ€§ã€çœä»½ç­›é€‰å’Œç»Ÿè®¡åˆ†æ</p>
          <div class="feature-footer">
            <el-button type="warning" link>ç«‹å³ä½¿ç”¨ â†’</el-button>
          </div>
        </el-card>
      </el-col>
    </el-row>

    <!-- å…¨å±€æ•°æ®ç®¡ç†å¡ç‰‡ -->
    <el-row :gutter="20">
      <el-col :span="24">
        <el-card shadow="hover" class="global-data-card">
          <template #header>
            <div class="card-header">
              <span class="header-title">
                <el-icon style="vertical-align: middle; margin-right: 8px;"><FolderOpened /></el-icon>
                å…¨å±€é’»å­”æ•°æ®ç®¡ç†
              </span>
              <div>
                <el-tag v-if="globalDataStore.keyStratumData.length > 0" type="primary" size="large">
                  {{ globalDataStore.keyStratumData.length }} æ¡è®°å½•
                </el-tag>
              </div>
            </div>
          </template>
          
          <div v-if="!hasGlobalData" class="empty-state">
            <el-empty description="æš‚æ— å…¨å±€é’»å­”æ•°æ®ï¼Œè¯·å…ˆå¯¼å…¥åŸå§‹å²©å±‚æ•°æ®">
              <el-button type="primary" size="large" @click="triggerFileSelect">
                <el-icon style="margin-right: 8px;"><Upload /></el-icon>
                å¯¼å…¥é’»å­”æ•°æ®
              </el-button>
            </el-empty>
          </div>
          
          <div v-else class="data-summary">
            <div class="summary-grid">
              <div class="summary-item">
                <el-icon class="summary-icon" color="#409EFF"><Document /></el-icon>
                <div class="summary-label">è®°å½•æ•°é‡</div>
                <div class="summary-value">{{ globalDataStore.keyStratumData.length }}</div>
              </div>
              <div class="summary-item">
                <el-icon class="summary-icon" color="#67C23A"><Grid /></el-icon>
                <div class="summary-label">å­—æ®µæ•°é‡</div>
                <div class="summary-value">{{ globalDataStore.keyStratumColumns.length }}</div>
              </div>
              <div class="summary-item">
                <el-icon class="summary-icon" color="#E6A23C"><Location /></el-icon>
                <div class="summary-label">é’»å­”æ•°é‡</div>
                <div class="summary-value">{{ uniqueBoreholes }}</div>
              </div>
              <div class="summary-item">
                <el-icon class="summary-icon" color="#F56C6C"><SuccessFilled /></el-icon>
                <div class="summary-label">æ•°æ®çŠ¶æ€</div>
                <div class="summary-value">åŸå§‹æ•°æ®</div>
              </div>
            </div>
            
            <div class="action-buttons">
              <el-button type="primary" @click="triggerFileSelect">
                <el-icon style="margin-right: 6px;"><RefreshRight /></el-icon>
                é‡æ–°å¯¼å…¥
              </el-button>
              <el-button type="info" @click="previewGlobalData">
                <el-icon style="margin-right: 6px;"><View /></el-icon>
                é¢„è§ˆæ•°æ®
              </el-button>
              <el-button type="warning" @click="exportGlobalData">
                <el-icon style="margin-right: 6px;"><Download /></el-icon>
                å¯¼å‡ºCSV
              </el-button>
              <el-button type="danger" @click="clearGlobalData">
                <el-icon style="margin-right: 6px;"><Delete /></el-icon>
                æ¸…ç©ºæ•°æ®
              </el-button>
            </div>
          </div>
        </el-card>
      </el-col>
    </el-row>

    <!-- æ•°æ®å¯è§†åŒ–ç»Ÿè®¡ -->
    <el-row :gutter="20">
      <el-col :span="24">
        <el-card shadow="hover" class="chart-card">
          <template #header>
            <div class="card-header">
              <span class="header-title">
                <el-icon style="vertical-align: middle; margin-right: 8px;"><TrendCharts /></el-icon>
                æ•°æ®ç»Ÿè®¡æ¦‚è§ˆ
              </span>
              <el-radio-group v-model="chartType" size="small">
                <el-radio-button value="bar">æŸ±çŠ¶å›¾</el-radio-button>
                <el-radio-button value="pie">é¥¼å›¾</el-radio-button>
              </el-radio-group>
            </div>
          </template>
          <div id="statsChart" style="width: 100%; height: 360px;"></div>
        </el-card>
      </el-col>
    </el-row>

    <!-- æœ€è¿‘æ´»åŠ¨ -->
    <el-row :gutter="20">
      <el-col :span="24">
        <el-card shadow="hover" class="activity-card">
          <template #header>
            <div class="card-header">
              <span class="header-title">
                <el-icon style="vertical-align: middle; margin-right: 8px;"><Clock /></el-icon>
                æœ€è¿‘æ“ä½œè®°å½•
              </span>
            </div>
          </template>
          <el-timeline>
            <el-timeline-item
              v-for="(activity, index) in recentActivities"
              :key="index"
              :timestamp="activity.time"
              :color="activity.color"
              placement="top"
            >
              <div class="activity-content">
                <el-icon :color="activity.color" style="margin-right: 8px;">
                  <component :is="activity.icon" />
                </el-icon>
                <span>{{ activity.text }}</span>
              </div>
            </el-timeline-item>
          </el-timeline>
          <div v-if="recentActivities.length === 0" class="empty-activity">
            <el-empty description="æš‚æ— æ“ä½œè®°å½•" :image-size="80" />
          </div>
        </el-card>
      </el-col>
    </el-row>

    <!-- è¾…åŠ©å·¥å…·ä¸å¸®åŠ© -->
    <el-row :gutter="20">
      <el-col :span="24">
        <el-card shadow="hover" class="tools-help-card">
          <template #header>
            <div class="card-header">
              <span class="header-title">
                <el-icon style="vertical-align: middle; margin-right: 8px;"><Edit /></el-icon>
                å¿«æ·å·¥å…·ä¸å¸®åŠ©
              </span>
            </div>
          </template>
          <div class="tools-help-grid">
            <!-- æ•°æ®å¤„ç†å·¥å…· -->
            <div class="tool-item" @click="$router.push('/csv-formatter')">
              <el-icon class="tool-icon" color="#409EFF"><Document /></el-icon>
              <div class="tool-info">
                <div class="tool-name">CSV æ ¼å¼åŒ–å·¥å…·</div>
                <div class="tool-desc">è½¬æ¢å’Œè§„èŒƒåŒ–CSVæ–‡ä»¶æ ¼å¼</div>
              </div>
              <el-icon><ArrowRight /></el-icon>
            </div>
            <div class="tool-item" @click="$router.push('/borehole-analysis')">
              <el-icon class="tool-icon" color="#67C23A"><DataLine /></el-icon>
              <div class="tool-info">
                <div class="tool-name">é’»å­”æ•°æ®åˆ†æ</div>
                <div class="tool-desc">æ‰¹é‡åˆ†æé’»å­”æ–‡ä»¶,æå–ç…¤å±‚ä¿¡æ¯</div>
              </div>
              <el-icon><ArrowRight /></el-icon>
            </div>

            <!-- å¸®åŠ©æ–‡æ¡£ -->
            <div class="tool-item" @click="showQuickStart = true">
              <el-icon class="tool-icon" color="#E6A23C"><Guide /></el-icon>
              <div class="tool-info">
                <div class="tool-name">å¿«é€Ÿå¼€å§‹æŒ‡å—</div>
                <div class="tool-desc">5åˆ†é’Ÿäº†è§£ç³»ç»Ÿä½¿ç”¨æ–¹æ³•</div>
              </div>
              <el-icon><ArrowRight /></el-icon>
            </div>
            <div class="tool-item" @click="showFAQ = true">
              <el-icon class="tool-icon" color="#F56C6C"><QuestionFilled /></el-icon>
              <div class="tool-info">
                <div class="tool-name">å¸¸è§é—®é¢˜è§£ç­”</div>
                <div class="tool-desc">å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ</div>
              </div>
              <el-icon><ArrowRight /></el-icon>
            </div>
          </div>
        </el-card>
      </el-col>
    </el-row>

    <!-- å¯¼å…¥æ•°æ®å¯¹è¯æ¡† -->
    <!-- éšè—çš„æ–‡ä»¶è¾“å…¥æ¡† -->
    <input ref="boreholeFileInput" type="file" multiple accept=".csv" class="hidden-input" @change="handleBoreholeImport" />
    
    <!-- æ•°æ®é¢„è§ˆå¯¹è¯æ¡† -->
    <el-dialog v-model="showPreviewDialog" title="å…¨å±€æ•°æ®é¢„è§ˆ" width="90%" top="5vh">
      <div style="margin-bottom: 12px;">
        <el-text>
          æ˜¾ç¤ºå‰ 100 æ¡è®°å½• (å…± {{ globalDataStore.keyStratumData.length }} æ¡åŸå§‹é’»å­”æ•°æ®)
        </el-text>
      </div>
      <el-table :data="previewData" border stripe height="60vh" style="width: 100%">
        <el-table-column
          v-for="col in (previewData.length > 0 ? Object.keys(previewData[0]) : [])"
          :key="col"
          :prop="col"
          :label="col"
          min-width="120"
          show-overflow-tooltip
        />
      </el-table>
    </el-dialog>

    <!-- å¿«é€Ÿå¼€å§‹æ•™ç¨‹å¯¹è¯æ¡† -->
    <el-dialog v-model="showQuickStart" title="ğŸ“– å¿«é€Ÿå¼€å§‹æŒ‡å—" width="800px" top="5vh">
      <el-scrollbar max-height="70vh">
        <div class="tutorial-content">
          <el-steps :active="activeStep" finish-status="success" align-center>
            <el-step title="å‡†å¤‡æ•°æ®" />
            <el-step title="å¯¼å…¥æ•°æ®" />
            <el-step title="å¼€å§‹åˆ†æ" />
          </el-steps>

          <div class="step-content">
            <!-- æ­¥éª¤1: å‡†å¤‡æ•°æ® -->
            <div v-show="activeStep === 0" class="tutorial-step">
              <h3>ğŸ“ æ­¥éª¤1: å‡†å¤‡é’»å­”æ•°æ®æ–‡ä»¶</h3>
              <el-alert type="info" :closable="false" style="margin: 16px 0;">
                <p><strong>æ”¯æŒçš„æ–‡ä»¶æ ¼å¼:</strong> CSVæ–‡ä»¶ (UTF-8æˆ–GBKç¼–ç )</p>
              </el-alert>
              
              <p><strong>é’»å­”æ•°æ®æ–‡ä»¶åº”åŒ…å«ä»¥ä¸‹åˆ—:</strong></p>
              <ul class="tutorial-list">
                <li><code>å²©å±‚åç§°</code> æˆ– <code>å²©å±‚</code> - å²©å±‚çš„åç§°</li>
                <li><code>åšåº¦/m</code> æˆ– <code>åšåº¦</code> - å²©å±‚åšåº¦(ç±³)</li>
                <li><code>å¼¹æ€§æ¨¡é‡/GPa</code> - å²©çŸ³å¼¹æ€§æ¨¡é‡</li>
                <li><code>å®¹é‡/kNÂ·m-3</code> - å²©çŸ³å®¹é‡</li>
                <li><code>æŠ—æ‹‰å¼ºåº¦/MPa</code> - å²©çŸ³æŠ—æ‹‰å¼ºåº¦</li>
                <li>å…¶ä»–åŠ›å­¦å‚æ•°(å¯é€‰)</li>
              </ul>

              <el-alert type="warning" :closable="false" style="margin: 16px 0;">
                <p><strong>æ³¨æ„äº‹é¡¹:</strong></p>
                <ul style="margin: 8px 0; padding-left: 20px;">
                  <li>æ¯ä¸ªCSVæ–‡ä»¶ä»£è¡¨ä¸€ä¸ªé’»å­”</li>
                  <li>æ–‡ä»¶åå°†ä½œä¸ºé’»å­”åç§°</li>
                  <li>å¯æ‰¹é‡å¯¼å…¥å¤šä¸ªé’»å­”æ–‡ä»¶</li>
                </ul>
              </el-alert>
            </div>

            <!-- æ­¥éª¤2: å¯¼å…¥æ•°æ® -->
            <div v-show="activeStep === 1" class="tutorial-step">
              <h3>ğŸ“¤ æ­¥éª¤2: å¯¼å…¥é’»å­”æ•°æ®</h3>
              
              <div class="tutorial-section">
                <h4>æ–¹æ³•ä¸€: é€šè¿‡é¦–é¡µå¯¼å…¥ (æ¨è)</h4>
                <ol class="tutorial-list">
                  <li>ç‚¹å‡» <el-button type="primary" size="small" plain>å¯¼å…¥é’»å­”æ•°æ®</el-button> æŒ‰é’®</li>
                  <li>é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªé’»å­”CSVæ–‡ä»¶</li>
                  <li>ç³»ç»Ÿè‡ªåŠ¨è§£æå¹¶æ˜¾ç¤ºå¯¼å…¥ç»“æœ</li>
                  <li>æ•°æ®å°†ä¿å­˜åˆ°å…¨å±€å­˜å‚¨,ä¾›æ‰€æœ‰æ¨¡å—ä½¿ç”¨</li>
                </ol>
              </div>

              <div class="tutorial-section">
                <h4>æ–¹æ³•äºŒ: åœ¨åŠŸèƒ½æ¨¡å—ä¸­å¯¼å…¥</h4>
                <ul class="tutorial-list">
                  <li><strong>å…³é”®å±‚è®¡ç®—:</strong> ç›´æ¥åœ¨æ¨¡å—å†…ä¸Šä¼ å²©å±‚æ•°æ®æ–‡ä»¶</li>
                  <li><strong>ä¸‰ç»´å»ºæ¨¡:</strong> éœ€åŒæ—¶ä¸Šä¼ é’»å­”æ•°æ®å’Œåæ ‡æ–‡ä»¶</li>
                </ul>
              </div>

              <el-alert type="success" :closable="false" style="margin: 16px 0;">
                <p><strong>âœ… å¯¼å…¥æˆåŠŸå,æ‚¨å°†çœ‹åˆ°:</strong></p>
                <ul style="margin: 8px 0; padding-left: 20px;">
                  <li>è®°å½•æ€»æ•°å’Œé’»å­”æ•°é‡ç»Ÿè®¡</li>
                  <li>æ•°æ®é¢„è§ˆå’Œç®¡ç†åŠŸèƒ½</li>
                  <li>å¯éšæ—¶å¯¼å‡ºæˆ–æ¸…ç©ºæ•°æ®</li>
                </ul>
              </el-alert>
            </div>

            <!-- æ­¥éª¤3: å¼€å§‹åˆ†æ -->
            <div v-show="activeStep === 2" class="tutorial-step">
              <h3>ğŸš€ æ­¥éª¤3: ä½¿ç”¨åŠŸèƒ½æ¨¡å—</h3>
              
              <div class="module-guide">
                <el-card class="module-card" shadow="hover">
                  <h4>ğŸ”¬ å…³é”®å±‚è®¡ç®—</h4>
                  <p><strong>åŠŸèƒ½:</strong> è‡ªåŠ¨è¯†åˆ«ç…¤å±‚ä¸Šè¦†å²©å±‚ä¸­çš„å…³é”®å±‚ä½ç½®</p>
                  <p><strong>ä½¿ç”¨æ­¥éª¤:</strong></p>
                  <ol style="font-size: 13px; padding-left: 20px;">
                    <li>ä¸Šä¼ é’»å­”å²©å±‚æ•°æ®æ–‡ä»¶</li>
                    <li>é€‰æ‹©æ˜¯å¦ä»æ•°æ®åº“å¡«å……ç¼ºå¤±å‚æ•°</li>
                    <li>é€‰æ‹©ç›®æ ‡ç…¤å±‚</li>
                    <li>ç‚¹å‡»"è®¡ç®—å…³é”®å±‚"</li>
                    <li>æŸ¥çœ‹ç»“æœå¹¶å¯¼å‡ºExcel/CSV</li>
                  </ol>
                </el-card>

                <el-card class="module-card" shadow="hover">
                  <h4>ğŸ—ºï¸ ä¸‰ç»´åœ°è´¨å»ºæ¨¡</h4>
                  <p><strong>åŠŸèƒ½:</strong> åŸºäºé’»å­”æ•°æ®ç”Ÿæˆç…¤å±‚ä¸‰ç»´å—ä½“æ¨¡å‹</p>
                  <p><strong>ä½¿ç”¨æ­¥éª¤:</strong></p>
                  <ol style="font-size: 13px; padding-left: 20px;">
                    <li>ä¸Šä¼ é’»å­”æ•°æ®å’Œåæ ‡æ–‡ä»¶</li>
                    <li>é€‰æ‹©Xã€Yåæ ‡åˆ—å’Œåšåº¦åˆ—</li>
                    <li>é€‰æ‹©è¦å»ºæ¨¡çš„ç…¤å±‚</li>
                    <li>é€‰æ‹©æ’å€¼æ–¹æ³•(çº¿æ€§/ä¸‰æ¬¡/RBFç­‰)</li>
                    <li>ç”Ÿæˆå¹¶æŸ¥çœ‹3Då¯è§†åŒ–æ¨¡å‹</li>
                  </ol>
                </el-card>

                <el-card class="module-card" shadow="hover">
                  <h4>ğŸ’¾ å²©æ€§æ•°æ®åº“</h4>
                  <p><strong>åŠŸèƒ½:</strong> æŸ¥è¯¢å’Œç®¡ç†å²©çŸ³åŠ›å­¦å‚æ•°æ•°æ®åº“</p>
                  <p><strong>ä½¿ç”¨æ­¥éª¤:</strong></p>
                  <ol style="font-size: 13px; padding-left: 20px;">
                    <li>æµè§ˆæ•°æ®åº“æ¦‚è§ˆå’Œç»Ÿè®¡</li>
                    <li>æŒ‰å²©æ€§æˆ–çœä»½ç­›é€‰è®°å½•</li>
                    <li>æŸ¥çœ‹å²©æ€§å‚æ•°ç»Ÿè®¡ä¿¡æ¯</li>
                    <li>ç¼–è¾‘æˆ–æ·»åŠ æ–°è®°å½•</li>
                  </ol>
                </el-card>
              </div>

              <el-alert type="info" :closable="false" style="margin: 16px 0;">
                <p><strong>ğŸ’¡ æç¤º:</strong> å»ºè®®å…ˆåœ¨é¦–é¡µå¯¼å…¥å…¨å±€é’»å­”æ•°æ®,ç„¶ååœ¨å„åŠŸèƒ½æ¨¡å—ä¸­ç›´æ¥ä½¿ç”¨!</p>
              </el-alert>
            </div>
          </div>

          <div class="tutorial-navigation">
            <el-button v-if="activeStep > 0" @click="activeStep--">ä¸Šä¸€æ­¥</el-button>
            <el-button v-if="activeStep < 2" type="primary" @click="activeStep++">ä¸‹ä¸€æ­¥</el-button>
            <el-button v-if="activeStep === 2" type="success" @click="showQuickStart = false">å¼€å§‹ä½¿ç”¨</el-button>
          </div>
        </div>
      </el-scrollbar>
    </el-dialog>

    <!-- å¸¸è§é—®é¢˜å¯¹è¯æ¡† -->
    <el-dialog v-model="showFAQ" title="â“ å¸¸è§é—®é¢˜è§£ç­”" width="800px" top="5vh">
      <el-scrollbar max-height="70vh">
        <div class="faq-content">
          <el-collapse accordion>
            <el-collapse-item name="1">
              <template #title>
                <span class="faq-title">â“ ä¸Šä¼ æ–‡ä»¶åæç¤º"ç¼ºå°‘å¿…éœ€åˆ—"æ€ä¹ˆåŠ?</span>
              </template>
              <div class="faq-answer">
                <p><strong>åŸå› :</strong> CSVæ–‡ä»¶ç¼ºå°‘å¿…éœ€çš„åˆ—åæˆ–åˆ—åæ ¼å¼ä¸æ­£ç¡®</p>
                <p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
                <ul>
                  <li>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦åŒ…å« <code>å²©å±‚åç§°</code> å’Œ <code>åšåº¦/m</code> åˆ—</li>
                  <li>ä½¿ç”¨"CSVæ ¼å¼åŒ–å·¥å…·"è½¬æ¢æ–‡ä»¶æ ¼å¼</li>
                  <li>ç¡®ä¿åˆ—åä¸ç³»ç»Ÿè¦æ±‚ä¸€è‡´(å¯ä½¿ç”¨ç¤ºä¾‹æ–‡ä»¶ä½œä¸ºå‚è€ƒ)</li>
                </ul>
              </div>
            </el-collapse-item>

            <el-collapse-item name="2">
              <template #title>
                <span class="faq-title">â“ å…³é”®å±‚è®¡ç®—æ—¶æç¤º"æœªæ‰¾åˆ°ç›®æ ‡å²©å±‚"?</span>
              </template>
              <div class="faq-answer">
                <p><strong>åŸå› :</strong> æ–‡ä»¶ä¸­ä¸åŒ…å«æ‚¨é€‰æ‹©çš„ç…¤å±‚åç§°</p>
                <p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
                <ul>
                  <li>ç‚¹å‡»"è·å–å¯é€‰ç…¤å±‚"æŒ‰é’®æŸ¥çœ‹æ–‡ä»¶ä¸­åŒ…å«çš„ç…¤å±‚</li>
                  <li>ç¡®ä¿é€‰æ‹©çš„ç…¤å±‚åç§°ä¸æ–‡ä»¶ä¸­å®Œå…¨ä¸€è‡´(åŒ…æ‹¬ç©ºæ ¼)</li>
                  <li>æ£€æŸ¥å²©å±‚åç§°åˆ—æ˜¯å¦æ­£ç¡®æ ‡è¯†äº†ç…¤å±‚</li>
                </ul>
              </div>
            </el-collapse-item>

            <el-collapse-item name="3">
              <template #title>
                <span class="faq-title">â“ ä¸‰ç»´å»ºæ¨¡æ—¶éƒ¨åˆ†å²©å±‚è¢«è·³è¿‡?</span>
              </template>
              <div class="faq-answer">
                <p><strong>åŸå› :</strong> æŸäº›å²©å±‚çš„æ•°æ®ç‚¹ä¸è¶³æˆ–æ•°æ®è´¨é‡é—®é¢˜</p>
                <p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
                <ul>
                  <li>æŸ¥çœ‹è·³è¿‡å²©å±‚çš„è¯¦ç»†è¯´æ˜</li>
                  <li>å¯¹äºæ•°æ®ç‚¹å¾ˆå°‘(1-3ä¸ª)çš„å²©å±‚,ç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨æœ€è¿‘é‚»æ’å€¼</li>
                  <li>å»ºè®®è¡¥å……æ›´å¤šé’»å­”æ•°æ®ä»¥æé«˜å»ºæ¨¡è´¨é‡</li>
                  <li>å¯ä»¥å–æ¶ˆé€‰æ‹©æ•°æ®ç‚¹ä¸è¶³çš„å²©å±‚</li>
                </ul>
              </div>
            </el-collapse-item>

            <el-collapse-item name="4">
              <template #title>
                <span class="faq-title">â“ å¦‚ä½•ä»æ•°æ®åº“å¡«å……ç¼ºå¤±çš„åŠ›å­¦å‚æ•°?</span>
              </template>
              <div class="faq-answer">
                <p><strong>æ“ä½œæ­¥éª¤:</strong></p>
                <ol>
                  <li>åœ¨å…³é”®å±‚è®¡ç®—æ¨¡å—ä¸Šä¼ é’»å­”æ–‡ä»¶å</li>
                  <li>ç‚¹å‡»"ä»æ•°æ®åº“å¡«å……"æŒ‰é’®</li>
                  <li>ç³»ç»Ÿè‡ªåŠ¨æ ¹æ®å²©å±‚åç§°åŒ¹é…æ•°æ®åº“ä¸­çš„ä¸­ä½å€¼</li>
                  <li>é¢„è§ˆå¡«å……åçš„æ•°æ®ç¡®è®¤æ— è¯¯</li>
                </ol>
                <p><strong>æ³¨æ„:</strong> åªä¼šå¡«å……ç©ºå€¼æˆ–0å€¼,ä¸ä¼šè¦†ç›–å·²æœ‰æ•°æ®</p>
              </div>
            </el-collapse-item>

            <el-collapse-item name="5">
              <template #title>
                <span class="faq-title">â“ ä¸‰ç»´å»ºæ¨¡é€‰æ‹©å“ªç§æ’å€¼æ–¹æ³•å¥½?</span>
              </template>
              <div class="faq-answer">
                <p><strong>æ¨èé€‰æ‹©:</strong></p>
                <ul>
                  <li><strong>çº¿æ€§æ’å€¼ (Linear):</strong> é€‚åˆæ•°æ®ç‚¹è¾ƒå°‘,é€Ÿåº¦å¿«,å¹³æ»‘åº¦ä¸€èˆ¬</li>
                  <li><strong>ä¸‰æ¬¡æ ·æ¡ (Cubic):</strong> é€‚åˆæ•°æ®ç‚¹å……è¶³(9ä¸ªä»¥ä¸Š),å¹³æ»‘åº¦å¥½</li>
                  <li><strong>å¾„å‘åŸºå‡½æ•° (RBF):</strong> é€‚åˆå¤æ‚æ›²é¢,è®¡ç®—é‡å¤§</li>
                  <li><strong>æœ€è¿‘é‚» (Nearest):</strong> é€‚åˆæå°‘æ•°æ®ç‚¹,ä¸å¹³æ»‘</li>
                </ul>
                <p><strong>æç¤º:</strong> å¯ä½¿ç”¨"æ’å€¼æ–¹æ³•å¯¹æ¯”"åŠŸèƒ½è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ–¹æ³•</p>
              </div>
            </el-collapse-item>

            <el-collapse-item name="6">
              <template #title>
                <span class="faq-title">â“ CSVæ–‡ä»¶ç¼–ç é—®é¢˜å¯¼è‡´ä¹±ç ?</span>
              </template>
              <div class="faq-answer">
                <p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p>
                <ul>
                  <li>ç³»ç»Ÿè‡ªåŠ¨æ”¯æŒ UTF-8ã€UTF-8-BOM å’Œ GBK ç¼–ç </li>
                  <li>å¦‚ä»æœ‰ä¹±ç ,ç”¨Excelæ‰“å¼€æ–‡ä»¶,å¦å­˜ä¸º UTF-8 CSV</li>
                  <li>æˆ–ç”¨è®°äº‹æœ¬æ‰“å¼€,é€‰æ‹©"å¦å­˜ä¸º",ç¼–ç é€‰æ‹©UTF-8</li>
                </ul>
              </div>
            </el-collapse-item>
          </el-collapse>

          <el-alert type="info" :closable="false" style="margin-top: 20px;">
            <p><strong>ğŸ’¡ è¿˜æœ‰å…¶ä»–é—®é¢˜?</strong></p>
            <p>æŸ¥çœ‹å®Œæ•´æ–‡æ¡£: <code>README.md</code> | <code>QUICKSTART.md</code></p>
          </el-alert>
        </div>
      </el-scrollbar>
    </el-dialog>
  </div>
</template>

<script setup>
import { ref, onMounted, computed, watch, nextTick } from 'vue';
import { ElMessage, ElMessageBox } from 'element-plus';
import {
  Coin, Files, Picture, UploadFilled, DataAnalysis, Guide,
  FolderOpened, Upload, Document, Grid, Location, SuccessFilled,
  RefreshRight, View, Download, Delete, Edit, ArrowRight,
  QuestionFilled, DataLine, TrendCharts, Clock
} from '@element-plus/icons-vue';
import * as echarts from 'echarts';
import { getApiBase } from '@/utils/api';
import { useGlobalDataStore } from '@/stores/globalData';

// åˆå§‹åŒ–store
const globalDataStore = useGlobalDataStore();

const API_BASE = getApiBase();
const stats = ref({
  rock_db_count: 0,
  borehole_file_count: 0,
  modeling_record_count: 0
});

const showPreviewDialog = ref(false);
const showQuickStart = ref(false);
const showFAQ = ref(false);
const isImporting = ref(false);
const activeStep = ref(0);
const boreholeFileInput = ref(null);

// ç›´æ¥è§¦å‘æ–‡ä»¶é€‰æ‹©
const triggerFileSelect = () => {
  boreholeFileInput.value?.click();
};

// å›¾è¡¨ç›¸å…³
const chartType = ref('bar');
let myChart = null;

// æœ€è¿‘æ´»åŠ¨
const recentActivities = ref([
  { time: 'åˆšåˆš', text: 'ç³»ç»Ÿå¯åŠ¨æˆåŠŸ', color: '#67C23A', icon: 'SuccessFilled' },
  { time: '5åˆ†é’Ÿå‰', text: 'æ•°æ®åº“è¿æ¥æ­£å¸¸', color: '#409EFF', icon: 'Coin' },
  { time: '10åˆ†é’Ÿå‰', text: 'å‰ç«¯æœåŠ¡å·²å¯åŠ¨', color: '#E6A23C', icon: 'Monitor' }
]);

const hasGlobalData = computed(() => 
  globalDataStore.boreholeData.length > 0 || 
  globalDataStore.keyStratumData.length > 0
);

const uniqueBoreholes = computed(() => {
  const data = globalDataStore.keyStratumData;
  if (!data || !data.length) return 0;
  const boreholes = new Set(data.map(row => row['é’»å­”å'] || row['é’»å­”'] || row['BK']).filter(Boolean));
  return boreholes.size;
});

const previewData = computed(() => {
  // åªæ˜¾ç¤ºå²©å±‚æ•°æ®(é’»å­”åŸå§‹æ•°æ®)
  if (globalDataStore.keyStratumData.length > 0) {
    return globalDataStore.keyStratumData.slice(0, 100);
  }
  return [];
});

const fetchStats = async () => {
  try {
    const response = await fetch(`${API_BASE}/dashboard/stats`);
    
    // æ£€æŸ¥å“åº”çŠ¶æ€
    if (!response.ok) {
      console.error('æœåŠ¡å™¨è¿”å›é”™è¯¯çŠ¶æ€:', response.status, response.statusText);
      // ä½¿ç”¨é»˜è®¤å€¼ï¼Œä¸æ˜¾ç¤ºé”™è¯¯
      stats.value = {
        rock_db_count: 0,
        borehole_file_count: 0,
        modeling_record_count: 0,
      };
      return;
    }
    
    // å°è¯•è§£æ JSON
    const res = await response.json();
    if (res.status === 'success') {
      stats.value = {
        rock_db_count: res.stats?.rock_db_count ?? 0,
        borehole_file_count: res.stats?.borehole_file_count ?? 0,
        modeling_record_count: res.stats?.modeling_record_count ?? 0,
      };
    } else {
      ElMessage.error(res.message || 'è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥');
    }
  } catch (e) {
    console.error('è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:', e);
    // ä½¿ç”¨é»˜è®¤å€¼ï¼Œä¸æ˜¾ç¤ºé‡å¤çš„é”™è¯¯æ¶ˆæ¯
    stats.value = {
      rock_db_count: 0,
      borehole_file_count: 0,
      modeling_record_count: 0,
    };
  }
};

const handleBoreholeImport = async (event) => {
  const files = Array.from(event.target.files || []);
  event.target.value = '';
  if (!files.length) return;

  isImporting.value = true;
  const formData = new FormData();
  files.forEach(file => formData.append('files', file));

  try {
    // ä½¿ç”¨åŸå§‹æ•°æ®å¯¼å…¥æ¥å£,ä¸åšä¸šåŠ¡å¤„ç†
    const res = await fetch(`${API_BASE}/raw/import`, {
      method: 'POST',
      body: formData,
    });
    const data = await res.json();
    
    if (!res.ok || data.status !== 'success') {
      throw new Error(data.detail || data.message || 'å¯¼å…¥å¤±è´¥');
    }

    const records = data.records || [];
    const columns = data.columns || [];
    const excludedColumns = data.excluded_columns || [];
    
    console.log('åŸå§‹é’»å­”æ•°æ®å¯¼å…¥æˆåŠŸ');
    console.log('è®°å½•æ•°:', records.length);
    console.log('ä¿ç•™çš„åˆ—å:', columns);
    console.log('æ’é™¤çš„åˆ—å:', excludedColumns);
    
    // ä¿å­˜åˆ°å²©å±‚æ•°æ®å­˜å‚¨(ç”¨äºå…³é”®å±‚è®¡ç®—)
    globalDataStore.loadKeyStratumData(
      records,
      columns
    );

    let message = `æˆåŠŸå¯¼å…¥ ${records.length} æ¡åŸå§‹é’»å­”æ•°æ®`;
    if (excludedColumns.length > 0) {
      message += ` (å·²è¿‡æ»¤ ${excludedColumns.length} ä¸ªè®¡ç®—å­—æ®µ)`;
    }
    
    ElMessage.success(message);
  } catch (error) {
    console.error('å¯¼å…¥é’»å­”æ•°æ®å¤±è´¥:', error);
    ElMessage.error(error.message || 'å¯¼å…¥å¤±è´¥');
  } finally {
    isImporting.value = false;
  }
};

const previewGlobalData = () => {
  showPreviewDialog.value = true;
};

const exportGlobalData = async () => {
  try {
    if (globalDataStore.keyStratumData.length === 0) {
      ElMessage.warning('æ²¡æœ‰å¯å¯¼å‡ºçš„æ•°æ®');
      return;
    }
    
    const records = globalDataStore.keyStratumData;
    const columns = globalDataStore.keyStratumColumns;
    const filename = `é’»å­”åŸå§‹æ•°æ®_${new Date().toISOString().slice(0,10)}.csv`;
    
    const csv = convertToCSV(records, columns);
    const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = filename;
    link.click();
    URL.revokeObjectURL(link.href);
    ElMessage.success('æ•°æ®å·²å¯¼å‡º');
  } catch (error) {
    console.error('å¯¼å‡ºå¤±è´¥:', error);
    ElMessage.error('å¯¼å‡ºå¤±è´¥');
  }
};

const convertToCSV = (records, columns) => {
  if (!records || !records.length) return '';
  const header = columns.join(',');
  const rows = records.map(record => 
    columns.map(col => {
      const value = record[col];
      return typeof value === 'string' && value.includes(',') ? `"${value}"` : value;
    }).join(',')
  );
  return [header, ...rows].join('\n');
};

const clearGlobalData = async () => {
  try {
    await ElMessageBox.confirm('ç¡®å®šè¦æ¸…ç©ºå…¨å±€æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚', 'è­¦å‘Š', {
      confirmButtonText: 'ç¡®å®š',
      cancelButtonText: 'å–æ¶ˆ',
      type: 'warning',
    });
    globalDataStore.clear();
    ElMessage.success('å·²æ¸…ç©ºå…¨å±€æ•°æ®');
  } catch {
    // ç”¨æˆ·å–æ¶ˆ
  }
};

// åˆå§‹åŒ–å›¾è¡¨
const initChart = () => {
  nextTick(() => {
    const chartDom = document.getElementById('statsChart');
    if (!chartDom) return;
    
    myChart = echarts.init(chartDom);
    updateChart();
  });
};

// æ›´æ–°å›¾è¡¨
const updateChart = () => {
  if (!myChart) return;
  
  const option = chartType.value === 'bar' ? getBarOption() : getPieOption();
  myChart.setOption(option);
};

// æŸ±çŠ¶å›¾é…ç½®
const getBarOption = () => {
  return {
    tooltip: {
      trigger: 'axis',
      axisPointer: { type: 'shadow' }
    },
    grid: {
      left: '3%',
      right: '4%',
      bottom: '3%',
      containLabel: true
    },
    xAxis: {
      type: 'category',
      data: ['å²©çŸ³æ•°æ®åº“', 'é’»å­”æ–‡ä»¶', 'å»ºæ¨¡è®°å½•', 'å…¨å±€é’»å­”'],
      axisLabel: { interval: 0, rotate: 0 }
    },
    yAxis: {
      type: 'value',
      name: 'æ•°é‡'
    },
    series: [
      {
        name: 'æ•°æ®ç»Ÿè®¡',
        type: 'bar',
        data: [
          { value: stats.value.rock_db_count, itemStyle: { color: '#667eea' } },
          { value: stats.value.borehole_file_count, itemStyle: { color: '#f093fb' } },
          { value: stats.value.modeling_record_count, itemStyle: { color: '#4facfe' } },
          { value: uniqueBoreholes.value, itemStyle: { color: '#43e97b' } }
        ],
        barWidth: '50%',
        label: {
          show: true,
          position: 'top',
          formatter: '{c}'
        }
      }
    ]
  };
};

// é¥¼å›¾é…ç½®
const getPieOption = () => {
  return {
    tooltip: {
      trigger: 'item',
      formatter: '{a} <br/>{b}: {c} ({d}%)'
    },
    legend: {
      orient: 'vertical',
      right: '10%',
      top: 'center'
    },
    series: [
      {
        name: 'æ•°æ®åˆ†å¸ƒ',
        type: 'pie',
        radius: ['40%', '70%'],
        avoidLabelOverlap: false,
        itemStyle: {
          borderRadius: 10,
          borderColor: '#fff',
          borderWidth: 2
        },
        label: {
          show: true,
          formatter: '{b}: {c}'
        },
        emphasis: {
          label: {
            show: true,
            fontSize: 16,
            fontWeight: 'bold'
          }
        },
        data: [
          { value: stats.value.rock_db_count, name: 'å²©çŸ³æ•°æ®åº“', itemStyle: { color: '#667eea' } },
          { value: stats.value.borehole_file_count, name: 'é’»å­”æ–‡ä»¶', itemStyle: { color: '#f093fb' } },
          { value: stats.value.modeling_record_count, name: 'å»ºæ¨¡è®°å½•', itemStyle: { color: '#4facfe' } },
          { value: uniqueBoreholes.value, name: 'å…¨å±€é’»å­”', itemStyle: { color: '#43e97b' } }
        ]
      }
    ]
  };
};

// ç›‘å¬å›¾è¡¨ç±»å‹å˜åŒ–
watch(chartType, () => {
  updateChart();
});

// ç›‘å¬æ•°æ®å˜åŒ–
watch(stats, () => {
  updateChart();
}, { deep: true });

// ç›‘å¬çª—å£å¤§å°å˜åŒ–
const handleResize = () => {
  if (myChart) {
    myChart.resize();
  }
};

onMounted(() => {
  fetchStats();
  initChart();
  window.addEventListener('resize', handleResize);
});
</script>

<style scoped>
.dashboard-container { 
  padding: 20px;
  background-color: #f0f2f5;
}

/* æ¬¢è¿å¡ç‰‡ */
.welcome-card { 
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white; 
  margin-bottom: 20px;
  border: none;
}

.welcome-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 0;
}

.welcome-text h1 { 
  margin: 0 0 12px 0; 
  font-size: 32px;
  font-weight: 700;
}

.welcome-text p {
  opacity: 0.95;
  font-size: 16px;
  margin: 0 0 16px 0;
}

.feature-tags {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.feature-tags .el-tag {
  font-size: 13px;
}

/* ç»Ÿè®¡å¡ç‰‡ */
.stats-row { 
  margin-bottom: 20px; 
}

.stat-card {
  transition: transform 0.3s ease;
}

.stat-card:hover {
  transform: translateY(-4px);
}

.stat-item { 
  display: flex; 
  align-items: center;
  padding: 4px 0;
}

.stat-icon {
  width: 64px; 
  height: 64px; 
  border-radius: 16px;
  display: flex; 
  align-items: center; 
  justify-content: center;
  font-size: 32px; 
  color: white; 
  margin-right: 16px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.stat-text {
  flex: 1;
}

.stat-title { 
  font-size: 13px; 
  color: #909399;
  margin-bottom: 4px;
}

.stat-value { 
  font-size: 28px; 
  font-weight: 700; 
  color: #303133;
  line-height: 1;
  margin-bottom: 2px;
}

.stat-label {
  font-size: 12px;
  color: #C0C4CC;
}

/* åŠŸèƒ½æ¨¡å—å¡ç‰‡ */
.feature-row {
  margin-bottom: 20px;
}

.feature-card {
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: center;
  padding: 16px 8px;
  min-height: 240px;
}

.feature-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 8px 24px rgba(0,0,0,0.12);
}

.feature-icon {
  width: 72px;
  height: 72px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 36px;
  color: white;
  margin: 0 auto 16px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.feature-card h3 {
  font-size: 18px;
  font-weight: 600;
  color: #303133;
  margin: 0 0 12px 0;
}

.feature-card p {
  font-size: 13px;
  color: #606266;
  line-height: 1.6;
  margin: 0 0 16px 0;
  min-height: 60px;
}

.feature-footer {
  margin-top: auto;
}

/* å…¨å±€æ•°æ®å¡ç‰‡ */
.global-data-card {
  margin-bottom: 20px;
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.header-title {
  font-size: 16px;
  font-weight: 600;
  color: #303133;
}

.empty-state {
  padding: 60px 20px;
  text-align: center;
}

.data-summary {
  padding: 12px 0;
}

.summary-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
  margin-bottom: 24px;
}

.summary-item {
  padding: 20px;
  background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf0 100%);
  border-radius: 12px;
  text-align: center;
  transition: all 0.3s ease;
}

.summary-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.summary-icon {
  font-size: 24px;
  margin-bottom: 8px;
}

.summary-label {
  font-size: 13px;
  color: #909399;
  margin: 8px 0;
}

.summary-value {
  font-size: 28px;
  font-weight: 700;
  color: #303133;
}

.action-buttons {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

/* å·¥å…·å’Œå¸®åŠ©å¡ç‰‡ */
.tools-help-card {
  margin-bottom: 20px;
}

.tools-help-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}

.tool-item {
  display: flex;
  align-items: center;
  padding: 16px;
  background: #f5f7fa;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.tool-item:hover {
  background: #e8ecf0;
  transform: translateX(4px);
}

.tool-icon {
  font-size: 28px;
  margin-right: 16px;
}

.tool-info {
  flex: 1;
}

.tool-name {
  font-size: 15px;
  font-weight: 600;
  color: #303133;
  margin-bottom: 4px;
}

.tool-desc {
  font-size: 13px;
  color: #909399;
}

/* å¯¹è¯æ¡†æ ·å¼ */
.import-section {
  padding: 40px 20px;
  text-align: center;
}

.import-tip {
  margin-top: 16px;
  color: #909399;
  font-size: 13px;
}

.hidden-input {
  display: none;
}

/* æ•™ç¨‹å†…å®¹ */
.tutorial-content {
  padding: 20px 0;
}

.step-content {
  min-height: 400px;
  margin-top: 32px;
}

.tutorial-step h3 {
  color: #303133;
  font-size: 20px;
  margin-bottom: 16px;
}

.tutorial-step h4 {
  color: #409EFF;
  font-size: 16px;
  margin: 20px 0 12px;
}

.tutorial-list {
  line-height: 1.8;
  color: #606266;
  padding-left: 24px;
}

.tutorial-list li {
  margin: 8px 0;
}

.tutorial-list code {
  background: #f5f7fa;
  padding: 2px 8px;
  border-radius: 4px;
  color: #409EFF;
  font-size: 13px;
}

.tutorial-section {
  margin: 24px 0;
}

.tutorial-navigation {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin-top: 32px;
  padding-top: 20px;
  border-top: 1px solid #e4e7ed;
}

.module-guide {
  display: grid;
  grid-template-columns: 1fr;
  gap: 16px;
  margin: 20px 0;
}

.module-card {
  margin-bottom: 0;
}

.module-card h4 {
  color: #303133;
  font-size: 16px;
  margin: 0 0 12px 0;
}

.module-card p {
  font-size: 13px;
  color: #606266;
  margin: 8px 0;
  line-height: 1.6;
}

/* FAQæ ·å¼ */
.faq-content {
  padding: 12px 0;
}

.faq-title {
  font-size: 15px;
  font-weight: 500;
  color: #303133;
}

.faq-answer {
  padding: 16px;
  background: #f5f7fa;
  border-radius: 8px;
  margin-top: 8px;
}

.faq-answer p {
  margin: 8px 0;
  color: #606266;
  font-size: 14px;
  line-height: 1.6;
}

.faq-answer ul,
.faq-answer ol {
  margin: 12px 0;
  padding-left: 24px;
  color: #606266;
  line-height: 1.8;
}

.faq-answer li {
  margin: 6px 0;
}

.faq-answer code {
  background: #e8ecf0;
  padding: 2px 8px;
  border-radius: 4px;
  color: #409EFF;
  font-size: 13px;
}

/* å›¾è¡¨å¡ç‰‡ */
.chart-card {
  margin-bottom: 20px;
}

/* æ´»åŠ¨å¡ç‰‡ */
.activity-card {
  margin-bottom: 20px;
}

.activity-content {
  display: flex;
  align-items: center;
  font-size: 14px;
  color: #606266;
}

.empty-activity {
  padding: 20px 0;
}

@media (max-width: 768px) {
  .summary-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .welcome-content {
    flex-direction: column;
    text-align: center;
  }

  .welcome-action {
    margin-top: 16px;
  }

  .tools-help-grid {
    grid-template-columns: 1fr;
  }
}
</style>